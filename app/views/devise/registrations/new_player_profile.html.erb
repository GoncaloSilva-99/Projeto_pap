<body class="bg-gray-900 text-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="max-w-md w-full">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="text-center mb-8 mt-8">
                <%= link_to root_path do %>
                    <%= image_tag "logo_sem_texto.png", alt: "Logo", class: "mx-auto mb-4", height: 70, width: 70 %>
                <% end %>
                <p class="text-indigo-100 font-bold mt-2">Crie a sua conta de jogador</p>
            </div>
            <!-- Progress Steps -->
            <div class="flex justify-between items-center mt-6 mb-8 px-10 relative">
                <div class="absolute left-[calc(12.5%)] right-[calc(12.5%)] top-4 h-1 bg-gray-700 -z-10">
                    <div class="h-full bg-primary-500 progress-line" style="width: 0%"></div>
                </div>
                <div class="step active" data-step="1">
                    <div class="w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center text-white font-medium mx-auto transition-all duration-300">1</div>
                    <p class="text-xs mt-1 text-gray-400 transition-all duration-300">Conta</p>
                </div>
                <div class="step" data-step="2">
                    <div class="w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-gray-400 font-medium mx-auto transition-all duration-300">2</div>
                    <p class="text-xs mt-1 text-gray-400 transition-all duration-300">Perfil</p>
                </div>
                <div class="step" data-step="3">
                    <div class="w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-gray-400 font-medium mx-auto transition-all duration-300">3</div>
                    <p class="text-xs mt-1 text-gray-400 transition-all duration-300">Criar</p>
                </div>
            </div>
</div>
        
        <!-- Multi-step Form -->
    <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "space-y-4", id: "multiStepForm" }) do |f| %>
        <% if resource.errors.any? %>
            <div class="mb-4 text-red-400 text-sm">
                <ul>
                    <% resource.errors.full_messages.each do |msg| %>
                    <li><%= msg %></li>
                    <% end %>
                </ul>
            </div>
        <% end %>
        
        <%= f.hidden_field :role, value: "Player" %>
            <!-- Step 1 -->
            <div class="step-content" data-step="1">
                <!-- Email -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Email</label>
                    <%= f.email_field :email, autofocus: true, autocomplete: "email", class: "w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent", placeholder: "sportX@email.com" %>
                </div>
                <!-- Password -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Password</label>
                    <%= f.password_field :password, autocomplete: "new-password", id: "password", class: "w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent", placeholder:"••••••••" %>
                    <div class="relative">
                        <button type="button" id="toggle-password" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-indigo-500">
                            <!-- Olho aberto -->
                            <svg id="eye-open-password" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                            <!-- Olho fechado  -->
                            <svg id="eye-closed-password" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.293-3.95M6.634 6.634A9.956 9.956 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.956 9.956 0 01-4.293 5.032M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3l18 18" />
                            </svg>
                        
                        
                        </button>
                    </div>
                </div>
                <!-- Confirmar Password -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Confirmar Password</label>
                    <%= f.password_field :password_confirmation, autocomplete: "new-password", id: "password-confirmation", class: "w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent", placeholder:"••••••••" %>
                    <div class="relative"> 
                        <button type="button" id="toggle-password-confirmation" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-indigo-500">
                            <!-- Olho aberto -->
                            <svg id="eye-open-password-confirmation" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                            <!-- Olho fechado  -->
                            <svg id="eye-closed-password-confirmation" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.293-3.95M6.634 6.634A9.956 9.956 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.956 9.956 0 01-4.293 5.032M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3l18 18" />
                            </svg>
                        
                        </button>
                    </div>
                </div>

                <div class="pt-4">
                    <button type="button" class="login-btn w-full bg-primary-500 hover:bg-primary-600 text-white font-medium py-2 px-4 rounded-md transition-all duration-300 hover:scale-[1.02] active:scale-95 shadow-lg hover:shadow-primary-500/30 next-step" data-next="2">
                        Continuar
                    </button>
                </div>
            
            
        </div>

            <!-- Step 2 -->
        <%= f.fields_for :player_profile do |pp| %>
            <div class="step-content hidden" data-step="2">
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Desporto</label>
                      <%= pp.select :sport, options_for_select(["Futebol", "Andebol"], pp.sport), { include_blank: "Escolha o desporto" }, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent" %>
                </div>
                <!-- Nome -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Nome</label>
                    <%= pp.text_field :name, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent", placeholder:"Ex. Juvesvaldo Ribeiro" %>
                </div>
                <!-- Data de nascimento -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Data de nascimento</label>
                    <%= pp.date_field :birth_date, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent" %>
                </div>
                <!-- Posição -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Posição</label>
                    <%= pp.select :position, grouped_options_for_select(@positions[current_user.sport.to_sym]), { include_blank: "Escolha a posição" }, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent" %>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Posição Secundária</label>
                      <%= pp.select :sport, options_for_select(PlayerProfile.sports.keys.map { |s| [s.titleize, s] }, pp.sport), { include_blank: "Escolha o desporto" }, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent" %>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Pé / Mão predominante</label>
                      <%= pp.select :dominant_foot_or_hand, options_for_select(["Direito", "Esquerdo"], pp.dominant_foot_or_hand), { include_blank: "Escolha a mão / pé predominante" }, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent" %>
                </div>
                <!-- Biografia -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Biografia</label>
                    <%= pp.textarea :bio, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent", placeholder:"Escreve uma breve descrição sobre ti. A informação estará visível para todos no teu perfil" %>
                </div>
                <!-- Contacto -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Contacto</label>
                    <%= pp.number_field :contact, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent", placeholder:"Tenho de ver como faço para colocar isto para selecionar o país do + e como fazer o regex" %>
                </div>
                <!-- Contacto dos pais -->
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Contacto dos pais</label>
                    <%= pp.number_field :parents_contact, class:"w-full bg-gray-800 rounded-md px-4 py-2 text-white border border-gray-700 focus:ring-2 focus:ring-secondary-500 focus:border-transparent", placeholder:"Tenho de ver como faço para colocar isto para selecionar o país do + e como fazer o regex" %>
                </div>

                <div class="flex justify-between pt-4">
                    <button type="button" class="w-32 bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-md transition-all duration-300 hover:scale-[1.02] active:scale-95 shadow-lg prev-step" data-prev="1">
                        Voltar
                    </button>
                    <button type="button" class="login-btn w-32 bg-primary-500 hover:bg-primary-600 text-white font-medium py-2 px-4 rounded-md transition-all duration-300 hover:scale-[1.02] active:scale-95 shadow-lg hover:shadow-primary-500/30 next-step" data-next="3">
                        Continuar
                    </button>
</div>
            </div>
                    
<% end %>
            <!-- Step 3 -->
            <div class="step-content hidden" data-step="3">
                <!-- Profile Picture -->
                <h1>ADICIONAR FOTO DE PERFIL COM GEM</h1>
                <div class="flex justify-between pt-4">
                    <button type="button" class="w-32 bg-gray-700 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-md transition-all duration-300 hover:scale-[1.02] active:scale-95 shadow-lg prev-step" data-prev="2">
                        Voltar
                    </button>
                    <%= f.submit "Criar Conta", class:"login-btn w-32 bg-primary-500 hover:bg-primary-600 text-white font-medium py-2 px-4 rounded-md transition-all duration-300 hover:scale-[1.02] active:scale-95 shadow-lg hover:shadow-primary-500/30" %>
        
</div>
            </div>
            <br>
            <div class="text-center text-sm text-gray-400">
                Already have an account? <a href="#" class="text-primary-500 hover:underline font-medium">Sign in</a>
            </div>
            

<% end %>

    
        <!-- Script para passar os steps -->

        <script>
            document.addEventListener('DOMContentLoaded', function() {
            const steps = Array.from(document.querySelectorAll('.step'));
            const stepContents = Array.from(document.querySelectorAll('.step-content'));
            const progressLine = document.querySelector('.progress-line');

            function showStep(stepNum) {
                // mostrar conteúdo
                stepContents.forEach(el => el.classList.add('hidden'));
                const content = document.querySelector(`.step-content[data-step="${stepNum}"]`);
                if (content) content.classList.remove('hidden');

                // atualizar indicadores
                steps.forEach(s => {
                const n = parseInt(s.dataset.step, 10);
                const circle = s.querySelector('div');
                if (n <= stepNum) {
                    s.classList.add('active');
                    if (circle) {
                    circle.classList.remove('bg-gray-700','text-gray-400');
                    circle.classList.add('bg-primary-500','text-white');
                    }
                } else {
                    s.classList.remove('active');
                    if (circle) {
                    circle.classList.add('bg-gray-700','text-gray-400');
                    circle.classList.remove('bg-primary-500','text-white');
                    }
                }
                });

                // atualizar linha de progresso
                const totalSteps = steps.length;
                const completed = Math.max(0, stepNum - 1);
                const percent = (completed / (totalSteps - 1)) * 100;
                if (progressLine) progressLine.style.width = `${percent}%`;
            }

            // inicializar
            showStep(1);

            // next / prev handlers 
            document.querySelectorAll('.next-step').forEach(btn => {
                btn.addEventListener('click', () => {
                const next = parseInt(btn.dataset.next, 10);
                if (!isNaN(next)) showStep(next);
                });
            });

            document.querySelectorAll('.prev-step').forEach(btn => {
                btn.addEventListener('click', () => {
                const prev = parseInt(btn.dataset.prev, 10);
                if (!isNaN(prev)) showStep(prev);
                });
            });
            });
        </script>

        <!-- CSS para os steps -->

        <style>
            .step.active p {
                color: #6366f1;
            }
            .step-content {
                transition: all 0.3s ease;
                animation: fadeIn 0.5s ease;
            }
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .progress-line {
                transition: width 0.5s ease;
            }
        </style>

    <!-- Configuração da cor principal e secundária do tailwind -->

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            500: '#6366f1',
                        },
                        secondary: {
                            500: '#8b5cf6',
                        }
                    }
                }
            }
        }
    </script>

    
<!-- JS de mostrar password (primeira) -->

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const toggleButtons = [
                {
                    input: document.getElementById("password"),
                    button: document.getElementById("toggle-password"),
                    eyeOpen: document.getElementById("eye-open-password"),
                    eyeClosed: document.getElementById("eye-closed-password")
                },
                {
                    input: document.getElementById("password-confirmation"),
                    button: document.getElementById("toggle-password-confirmation"),
                    eyeOpen: document.getElementById("eye-open-password-confirmation"),
                    eyeClosed: document.getElementById("eye-closed-password-confirmation")
                }
            ];

            toggleButtons.forEach(({input, button, eyeOpen, eyeClosed}) => {
                button.addEventListener("click", function() {
                    if (input.type === "password") {
                        input.type = "text";
                        eyeOpen.classList.add("hidden");
                        eyeClosed.classList.remove("hidden");
                    } else {
                        input.type = "password";
                        eyeOpen.classList.remove("hidden");
                        eyeClosed.classList.add("hidden");
                    }
                });
            });
        });
    </script>

<!-- JS de mostrar password (confirmação) -->



    <!-- CSS para alinhar botão de ver password -->

    <style>
        #toggle-password, #toggle-password-confirmation {
            top: -20px; 
        }


    </style>




